# Afterlight — PRD v0.1 (RU)
Дата: 2025-08-13
Статус: Черновик (MVP)

## 1. Контекст и цели
Afterlight — платформа “цифрового завещания”: владелец заранее подготавливает зашифрованные данные (“сейф”), доступ к которым открывается после подтверждённого события (смерть/недееспособность) при достижении кворума верификаторов. Ключевой принцип — клиентское шифрование и минимизация доверия к серверу.

**Цели MVP:**
- Запустить сквозной сценарий: создание сейфа → приглашение верификаторов → событие → кворум → grace → раскрытие блоков/публичных ссылок.
- Обеспечить базовую надёжность (health, deploy в staging) и юридическую валидность пользовательских соглашений.

## 2. Область MVP (In/Out)
**In:**
- События: смерть, недееспособность (например, Альцгеймер, кома, паралич).
- Кворум: 2 из 3 (по умолчанию на запуске). Primary Verifier не обязателен.
- Heartbeat: подтверждение жизненной активности фактом входа в аккаунт. Период — 1 год.
- Grace-период после наступления события — 24 часа.
- Команда споров: только метки статусов (без модерации в MVP).
- Аутентификация: e-mail (в будущем — телефон/2FA вне MVP).
- Восстановление доступа: стандартно через e-mail.
- Хранилище: S3-совместимое в РФ, подключено к серверу.
- Публичные ссылки (“послание миру”): весь блок, срок жизни 24 часа, noindex, CAPTCHA.
- Нотификации: e-mail (телефон/бот — позже).
- Регион запуска: РФ. Язык интерфейса: RU.

**Out (после MVP):**
- KYC/2FA/Passkeys.
- Поддержка-инициированное раскрытие (Фаза 3).
- Развёрнутая модерация/доказательства.
- Telegram-бот, SMS.
- Мульти-региональность и мультиязык.
- Продвинутые recovery-механизмы (Shamir, social recovery).

## 3. Персоны
- **Владелец**: создаёт сейфы, выбирает верификаторов, настраивает блоки и получателей.
- **Верификатор**: по e-mail подтверждает факт события, участвует в кворуме.
- **Получатель**: получает доступ к данным после финализации.
- **Поддержка** (позже): участвует в спорных кейсах.

## 4. Пользовательские сценарии (MVP)
1. Создание сейфа → добавление верификаторов (e-mail) → настройка блоков и получателей → публикация (сохранение).
2. Наступление события → инициирование процесса (кем-либо из верификаторов/получателей/владельцем в случае недееспособности) → сбор голосов → ожидание 24 ч → финализация и выдача доступа/публичной ссылки.
3. Heartbeat: если владелец входил в систему в течение последних 365 дней — событие отклоняется автоматически.

## 5. Нефункциональные требования
- Доступность: 99.5% для MVP-staging.
- Безопасность: клиентское шифрование контента, нулевое хранение открытых данных.
- Логи и аудит: следы действий по идентификаторам, без хранения секретов.
- Юридически значимые согласия (политики/соглашение) фиксируются в профиле.

## 6. Ограничения и принятые решения
- РФ, RU язык, S3 в РФ. Публичные ссылки — 24 ч, noindex, CAPTCHA. E-mail — единственный канал.
- Кворум 2/3, HB 1 год, grace 24 часа, без Primary Verifier по умолчанию.
- Восстановление по e-mail, без KYC в MVP.

## 7. Метрики
- Активация сейфа (% пользователей с ≥1 сейфом).
- Доля сейфов с полным набором верификаторов (3/3).
- Среднее время до достижения кворума.
- Доля финализированных раскрытий / отменённых HB.
- Конверсия приглашений верификаторов.
- Успешность “smoke”-сценария в staging.

## 8. Риски
- Юр. риски (152-ФЗ; обработка ПДн; обязанности оператора).
- Соц. риски (злоупотребление подтверждениями).
- Операционные (утеря доступа владельцем).
- Технические (e-mail доставляемость).

## 9. Открытые вопросы (исследование)
- Монетизация: ограничение объёма/количества сейфов или срок хранения? Комбинация? B2B white-label.
- Механика доказательств и споров в M1/M2.
- Вторичные каналы нотификаций (SMS/бот).
- Модель “поддержка-инициированное раскрытие” (Фаза 3).

## 10. Приёмочные критерии MVP (срез)
- Создание/редактирование сейфа, добавление N=3 верификаторов, установка кворума 2.
- Инициация события (смерть/недееспособность) → сбор ≥2 подтверждений → таймер 24 ч → финализация.
- Heartbeat: успешный вход в систему в течение 365 дней блокирует раскрытие.
- Публичная ссылка на блок: доступна 24 ч, с CAPTCHA, noindex; по истечении срока — 410 Gone.
- Health endpoint `/healthz` отдаёт 200 и версии.
- Развёртывание в staging (k8s) + сквозной smoke-тест проходит.
